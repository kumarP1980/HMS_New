<%- include('partials/header') %>
<div class="container mt-5"> 
    <nav class="navbar navbar-expand-lg navbar-dark">
  
        <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
      
          <ul class="nav navbar-nav navbar-right">
            <li id="medication"><a href="/medication/<%=id %>">Medication</a></li>
            <li id="diagnosis"><a href="/diagnosis/<%=id %>">Diagnosis</a></li>
            <!--<li id="labreport"><a href="/labreport">Lab Report</a></li>-->
          </ul>
      
        </div>
      </nav>     
    <h3>View Details</h3>        
    <div class="row">
        <div class="col-sm-8">
            <div class="card">
                <div class="card-body">

                    <!-- Makes POST request to /modify route -->
                        <input type="hidden" name="personID" value="<%=id%>" />
                        <div class="form-group">
                            <label for="fname">Name:</label><%=fname%> <%=lname%> (<%=age%> Years)    
                            <label for="phoneNumber">Phone:</label><%=areaCode%>-<%=phoneNumber%>        
                            <label for="email">Email:</label><%=email%>                   
                        </div>
                        <div class="form-group">
                            <label for="streetName">Address:</label>
                            <%=streetName%>,
                            <%=city%>,
                            <%=state%>,
                            <%=pinCode%>                        
                        </div>                        
                        <h4>Insurance</h4>                          
                        <table class="table table-sm">
                            <thead>
                              <tr>                            
                                <th scope="col">Provider Name</th>
                                <th scope="col">Group No#</th>
                                <th scope="col">Policy No#</th>                                
                                <th scope="col">Effective From</th>
                                <th scope="col">Phone#</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td><%=providerName%></td>
                                <td><%=groupNum%></td>                                    
                                <td><%=policyNum%></td>
                                <td><%=effectiveFrom%></td>                                    
                                <td><%=providerPhone%></td>                                
                              </tr>  
                                                      
                            </tbody>
                          </table>
                          <br>
                          <h4>Diagnosis</h4>                          
                        <table class="table table-sm">
                            <thead>
                              <tr>                            
                                <th scope="col">Date</th>
                                <th scope="col">Diagnosis</th>                                                           
                              </tr>
                            </thead>
                            <tbody>
                              <% diagnosisDtls.forEach(function(diagnosis){ %>
                                <tr>
                                    <td><%=diagnosis.diagnosisDate%></td>
                                    <td><%- diagnosis.details%></td>    
                                  </tr>  
                              <% }) %>                  
                            </tbody>
                          </table><br>
                          <h4>Medication</h4>                          
                        <table class="table table-sm">
                            <thead>
                              <tr>                            
                                <th scope="col">Name</th>
                                <th scope="col">Dose</th>
                                <th scope="col">Start Date</th>
                                <th scope="col">End Date</th>                                
                              </tr>
                            </thead>
                            <tbody>
                              <% let options = {
                                year: 'numeric',
                                month: 'long',
                                day: 'numeric'
                            };%>
                              <% medicationDtls.forEach(function(medication){ %>
                                <tr>
                                    <td><%= medication.name%></td>
                                    <td><%= medication.dose%></td>
                                    <td><%= medication.startDate.toLocaleDateString("en-US", options)%></td>
                                    <td><%= medication.endDate.toLocaleDateString("en-US", options)%></td>    
                                  </tr>  
                              <% }) %>  
                                                      
                            </tbody>
                          </table>

                </div>
            </div>
        </div>